<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact | AFFECTION TOKYO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300&family=Noto+Sans+JP:wght@300&display=swap" rel="stylesheet">
    <style>
        body { background-color: #fff; font-family: 'Noto Sans JP', sans-serif; }
        .font-serif-en { font-family: 'Cormorant Garamond', serif; }
        .form-input { border: 1px solid #eee; padding: 12px 16px; width: 100%; transition: all 0.3s; font-size: 0.9rem; }
        .form-input:focus { outline: none; border-color: #1a1a1a; }
        .btn-luxury { background-color: #111; color: #fff; padding: 20px 60px; text-transform: uppercase; font-size: 0.75rem; font-weight: 700; letter-spacing: 0.3em; transition: all 0.4s; }
        .btn-luxury:hover:not(:disabled) { background-color: #333; letter-spacing: 0.35em; }
    </style>
</head>
<body>
    <nav class="fixed top-0 right-0 p-8 z-50 flex gap-6 text-sm tracking-[0.2em] font-serif-en">
        <a href="index.html" class="hover:opacity-50 transition">TOP</a>
        <a href="brand/georgesuncinq.html" class="hover:opacity-50 transition">BRAND</a>
    </nav>
    <header class="p-6 md:p-12">
        <a href="index.html" class="font-serif-en text-xl md:text-2xl tracking-[0.2em] uppercase">Affection Tokyo</a>
    </header>

    <section class="py-20 md:py-32 max-w-xl mx-auto px-6">
        <div class="text-center mb-16">
            <h2 class="font-serif-en text-4xl font-light mb-4 italic">Inquiry Form</h2>
            <p class="text-[10px] tracking-widest text-neutral-400 uppercase">お問い合わせ</p>
        </div>

        <form onsubmit="handleSubmit(event)" class="space-y-10">
            <div class="space-y-2">
                <label class="block text-[10px] uppercase tracking-[0.2em] text-neutral-400">Company Name / 会社名</label>
                <input type="text" name="company" class="form-input">
            </div>
            <div class="grid grid-cols-2 gap-8">
                <div class="space-y-2">
                    <label class="block text-[10px] uppercase tracking-[0.2em] text-neutral-400">Surname / 姓</label>
                    <input type="text" name="surname" class="form-input" required>
                </div>
                <div class="space-y-2">
                    <label class="block text-[10px] uppercase tracking-[0.2em] text-neutral-400">Given Name / 名</label>
                    <input type="text" name="givenName" class="form-input" required>
                </div>
            </div>
            <div class="space-y-2">
                <label class="block text-[10px] uppercase tracking-[0.2em] text-neutral-400">Email Address / メールアドレス</label>
                <input type="email" name="email" class="form-input" required>
            </div>
            <div class="space-y-2">
                <label class="block text-[10px] uppercase tracking-[0.2em] text-neutral-400">Message / 内容</label>
                <textarea name="message" class="form-input h-48 resize-none" required></textarea>
            </div>
            <div class="text-center pt-8">
                <button type="submit" id="submitBtn" class="btn-luxury">Send Message</button>
            </div>
        </form>
    </section>

    <script>
        const GAS_URL = "https://script.google.com/macros/s/AKfycbwYmhJZ22K5gx-EYO7wIjb5MXNgU5v6qSFJeQHptwOicWORKMz53jJG71HAwvNpHMC8Dw/exec";

        async function handleSubmit(event) {
            event.preventDefault();
            const form = event.target;
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.innerText = "SENDING...";
            submitBtn.disabled = true;

            const data = {
                company: form.company.value,
                name: form.surname.value + " " + form.givenName.value,
                email: form.email.value,
                message: form.message.value
            };

            try {
                const response = await fetch(GAS_URL, { method: "POST", body: JSON.stringify(data) });
                const result = await response.json();
                if (result.result === "success") {
                    alert("ありがとうございます。メッセージは送信されました。");
                    window.location.href = "index.html";
                } else { throw new Error(); }
            } catch (e) {
                alert("送信に失敗しました。お電話にてお問い合わせください。");
            } finally {
                submitBtn.innerText = "Send Message";
                submitBtn.disabled = false;
            }
        }
    </script>
</body>
</html>